<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–°—Ç–∞–Ω –±–∞—Ç–∞—Ä–µ–π –ø–æ —Å—Ç–æ—è–∫–∞—Ö</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body { font-family: Arial, sans-serif; background:#f4f4f4; }
table { border-collapse: collapse; margin:20px auto; background:white; }
th,td { border:1px solid #999; padding:6px 8px; text-align:center; min-width:36px; }
th { background:#e0e0e0; }
.floor { font-weight:bold; background:#f0f0f0; }
.battery { cursor:pointer; border-radius:4px; font-weight:bold; }
.inactive { background:#bdbdbd; }
.hot { background:#4a90e2; color:white; }
.cold { background:#e74c3c; color:white; }
.empty { background:#fafafa; color:#aaa; }
  .last-update {
  margin-left: auto;
  font-size: 14px;
  color: #555;
}


.legend, .info {
  max-width:800px; margin:15px auto; background:white;
  padding:12px; border-radius:6px; border:1px solid #ccc;
}
.legend div { display:inline-block; padding:6px 10px; margin:4px; border-radius:4px; font-weight:bold; }
</style>
</head>
<body>

<div class="legend">
  <div class="inactive">‚ö™ –ù–µ–∞–∫—Ç–∏–≤–Ω–∞</div>
  <div class="hot">üîµ –•–æ–ª–æ–¥–Ω–∞</div>
  <div class="cold">üî¥ –ì–∞—Ä—è—á–∞</div>
<div id="lastUpdate" class="last-update">üïí –û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: ‚Äî </div>
</div>

<table id="table">
<tr>
  <th rowspan="2">–ü–æ–≤–µ—Ä—Ö</th>
  <th colspan="4">–õ—ñ–≤–µ –∫—Ä–∏–ª–æ</th>
  <th colspan="5">–ü—Ä–∞–≤–µ –∫—Ä–∏–ª–æ</th>
</tr>
<tr>
  <th></th><th></th><th></th><th></th>
  <th></th><th></th><th></th><th></th><th></th>
</tr>
</table>

<div class="info">
<b>–Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—å:</b><br>
–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –Ω–æ–º–µ—Ä –∫–≤–∞—Ä—Ç–∏—Ä–∏, —â–æ–± –∑–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞–Ω –±–∞—Ç–∞—Ä–µ—ó.<br>
‚ö™ ‚Üí üîµ ‚Üí üî¥ ‚Üí ‚ö™<br>
–ó–º—ñ–Ω–∏ –º–∏—Ç—Ç—î–≤–æ –±–∞—á–∞—Ç—å —É—Å—ñ, —Ö—Ç–æ –≤—ñ–¥–∫—Ä–∏–≤ —Å—Ç–æ—Ä—ñ–Ω–∫—É.
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

  const firebaseConfig = {
    ...
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  set(ref(db, "meta/lastUpdate"), Date.now());
onValue(ref(db, "meta/lastUpdate"), (snapshot) => {
  ...
});
initializeApp(...)
getDatabase(...)

</script>


<script>
const firebaseConfig = {
  apiKey: "AIzaSyD-XXXXXXXX",
  authDomain: "heating-map.firebaseapp.com",
  databaseURL: "https://heating-map-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "heating-map",
  storageBucket: "heating-map.appspot.com",
  messagingSenderId: "1234567890",
  appId: "1:1234567890:web:abcdef123456"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const ref = db.ref("batteries");

const floors = [
  [1,2,3,4,5,6],
  [7,8,9,10,11,12],
  [13,14,15,16,17,18,19,20,21],
  [22,23,24,25,26,27,28,29,30],
  [31,32,33,34,35,36,37,38,39],
  [40,41,42,43,44,45,46,47,48],
  [49,50,51,52,53,54,55,56,57],
  [58,59,60,61,62,63,64,65,66],
  [67,68,69,70,71,72,73,74,75],
  [76,77,78,79,80,81,82,83,84],
  [85,86,87,88,89,90,91,92,93],
  [94,95,96,97,98,99,null,100,101],
  [102,103,104,105,106,107,null,108,109],
  [110,111,112,113,114,115,null,116,117]
];

const table = document.getElementById("table");
const states = ["inactive","hot","cold"];

floors.forEach((row,i)=>{
  const tr=document.createElement("tr");
  const f=document.createElement("td");
  f.textContent=i+1; f.className="floor"; tr.appendChild(f);

  for(let c=0;c<9;c++){
    const td=document.createElement("td");
    if(row[c]==null){ td.textContent="‚Äî"; td.className="empty"; }
    else if(row[c]){
      td.textContent=row[c];
      td.className="battery inactive";
      td.onclick=()=>cycle(row[c]);
      ref.child(row[c]).on("value",s=>{
        if(s.exists()) td.className="battery "+s.val();
      });
    }
    tr.appendChild(td);
  }
  table.appendChild(tr);
});

function cycle(id){
  ref.child(id).get().then(s=>{
    let cur=s.val()||"inactive";
    let next=states[(states.indexOf(cur)+1)%states.length];
    ref.child(id).set(next);
  });
}
</script>

</body>
</html>




